<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>てっく煮ブログ</title>
		<link>http://tech.nitoyon.com/ja/blog/index.xml</link>
		<description>All Technology is Boiled in This Site.</description>
		<language>ja</language>
		<copyright>Copyright nitoyon.</copyright>
		<lastBuildDate>Mon, 03 Sep 2012 11:42:27 +0900</lastBuildDate>
		<docs>http://blogs.law.harvard.edu/tech/rss</docs>
		<atom:link href="http://tech.nitoyon.com/ja/blog/index.xml" rel="self" type="application/rss+xml" />









		<item>
			<title>暫定で「はてなブログ」に移転した</title>
			<link>http://tech.nitoyon.com/ja/blog/2012/08/27/hatena-blog/</link>
			<guid>http://tech.nitoyon.com/ja/blog/2012/08/27/hatena-blog/</guid>
			<pubDate>Mon, 27 Aug 2012 00:00:00 +0900</pubDate>
			<description><![CDATA[<p><a href="http://d.hatena.ne.jp/nitoyon/20120627/english_blog_renewal">以前</a>、「はてなブログは使う気ないよー」みたいなことを書いたにも関わらず、はてなブログに引っ越してみました。</p>
<p>これに従って、URL は <a href="http://d.hatena.ne.jp/nitoyon/">http://d.hatena.ne.jp/nitoyon/</a> から <a href="http://tech2.nitoyon.com/">http://tech2.nitoyon.com/</a> に変更になりました。旧 URL へのアクセスはすべて自動的にリダイレクトされます。</p>
<h1>今回の移転の理由</h1>
<p>将来的に、tech.nitoyon.com にて自前でホスティングしたいという夢は捨てていません。</p>
<p>ただ、その前に、はてなブログの有料プランを介在しておくことで</p>
<ul><li>旧 URL へのアクセスが、独自ドメインの URL にリダイレクトされる</li><li>はてなダイアリー上のページランクを新しい URL に引き継ぐことができる</li><li>はてなブックマーク数も新しいドメインに引き継ぐことができる</li></ul>
<p>というメリットを得られます。</p>
<p>本当なら tech2.nitoyon.com という中途半端なドメインを使わずに、直接 tech.nitoyon.com に移転したかったのですが、tech.nitoyon.com にはブログ以外のコンテンツがいくつか存在しています。その状態で tech.nitoyon.com の DNS の向き先を「はてなブログ」に向けてしまうと、既存のコンテンツが閲覧できなくなって悲しいわけです。移転先のドメインに何もコンテンツが存在していないのなら、直接、新しい URL にリダイレクトさせたと思います。そうすれば、後述する「次の移転」で URL が変わることはないので、よりハッピーだったでしょう。移転先を新しいサブドメイン名にしてもよかったのですが、tech.nitoyon.com というドメインに思い入れがあるので仕方ありません。</p>
<p>もう 1 つ、ひどい方法として、リダイレクトのためだけに「はてなブログ」の有料プランを使う方法も考えられます。移転するリダイレクトの設定だけしておいて、DNS の向き先を「はてなブログ」にしない、という作戦も考えられたのですが、そもそも動くのか分からないです。(はてなブログでリダイレクト先が存在しないなら xxxx.hatenablog.com にリダイレクト先を変えるような実装をしているかもしれない。実際、ドメインの確認ができてない時点で xxxx.hatenablog.com にアクセスしても、独自ドメインに転送してくれない)</p>
<p>何よりも、せっかく有料プランにするので、すこし試してみたい気持ちもありました。</p>
<p>ということで、いったん「はてなブログ」に引っ越すことにしました。</p>
<h1>すぐにやってくる次の移転計画</h1>
<p>このあとの計画は次のようになります。</p>
<ol><li>Google の検索結果が新 URL(tech2.nitoyon.com)になるまでじっと待つ。</li><li>自分のサーバーで tech.nitoyon.com に移転先のコンテンツを準備する。</li><li>自分のサーバーで tech2.nitoyon.com を tech.nitoyon.com にリダイレクトするように設定する。</li><li>tech2.nitoyon.com の DNS の向き先を「はてなブログ」から「自分のサーバー」に移動する。</li><li>d.hatena.ne.jp/nitoyon/ の各記事を「移転先はこちら」といった単純なリンクに書き換える。</li><li>はてなブログのリダイレクト機能を切る。(d.hatena.ne.jp/nitoyon → tech2.nitoyon.com にリダイレクトされなくなる)</li><li>はてなブログの有料プランを解約する。</li></ol>
<p>このようにすることで、</p>
<ul><li>d.hatena.ne.jp/nitoyon/ を開いた人 → 移転先のリンクが表示される。</li><li>tech2.nitoyon.com を開いた人 → 自動的にリダイレクトされる。</li></ul>
<p>という動作になるはずだと信じています。</p>
<h1>はてなブログを使ってみて</h1>
<p>ということで、いまさらながらに「はてなブログ」を使ってみているわけですが、作り直しただけはあって、インターフェースもすっきりしていて使いやすいですね。</p>]]></description>
		</item>

		<item>
			<title>DISQUS へのコメントのインポートが意外に面倒</title>
			<link>http://tech.nitoyon.com/ja/blog/2012/07/31/disqus-comment-import/</link>
			<guid>http://tech.nitoyon.com/ja/blog/2012/07/31/disqus-comment-import/</guid>
			<pubDate>Tue, 31 Jul 2012 00:00:00 +0900</pubDate>
			<description><![CDATA[<p>更新期間が開いてしまったが、ブログの<a href="http://d.hatena.ne.jp/nitoyon/20120627/english_blog_renewal">移転計画</a>を少しずつ進めている。</p>
<p>おおよその過去記事の表示は問題なくなったところであり、もう間もなく移転できるところまで来ているんだけど、コメント欄の移行で手間取っている。</p>
<p>新生ブログのコメント欄には<a href="http://disqus.com/">DISQUS</a>を採用することを検討している。DISQUS はコメント欄の請負サービスとしては最大手だろう。英語圏では CNN や Time、MLB.com などが、日本では <a href="http://jp.techcrunch.com/">TechCrunch JAPAN</a> などが採用している。</p>
<p>アカウント登録して、JavaScript を貼り付けるだけで高機能なコメント欄ができあがるので、気軽で便利なのである。</p>
<h1>インポートの戦略</h1>
<p>ただ、今回は既存のブログがあるので、「JavaScript を貼って、はい、終わり」とはいかない。</p>
<p>過去のコメントをインポートしたいのである。</p>
<p>幸い、DISQUS にはインポート機能がある。WordPress や Blogger、MovableType からのインポートはもちろん、<a href="http://help.disqus.com/customer/portal/articles/472150-custom-xml-import-format">特定の XML フォーマット</a>に従ってコメントを抽出すれば、任意のサービスからのインポートも可能になっている。</p>
<p>なるほど、これを使えば一件落着、と思って手を出してみた。</p>
<br />
<p>今回のインポート元は</p>
<ul><li>日本語ブログ: はてなダイアリー</li><li>英語ブログ: MovableType 3.33</li></ul>
<p>の２つ。</p>
<p>MovableType については DISQUS 側でエクスポートのためのプラグインが用意されている。しかし、よく見てみると MovableType 4.X 用しか用意されていない。3.33 でも動くのかもしれないが、MovableType が面倒になって移転しようとしているので、このためだけにプラグインを入れたり、バージョンアップしたりはしたくない。</p>
<p>一方、はてなダイアリーは MovableType 形式でのエクスポート機能がある。</p>
<p>ということは、両方のブログから MovableType のフォーマットでコメントを吐き出すことはできる。</p>
<p>あとは「MovableType のフォーマット → DISQUS インポート フォーマットへの変換スクリプト」を書けば、両方のブログから DISQUS にインポートできるはずだ。</p>
<h1>インポート 待ち時間の罠</h1>
<p>そんなわけで、せっせとスクリプトを<a href="https://github.com/nitoyon/tech.nitoyon.com/blob/master/_scripts/convert_mt_to_disqus.rb">書いた</a>。ただし、MovableType フォーマットには URL が含まれていないので、手動で XML に追記した。英語ブログには 2 つの記事にしかコメントがついてないので、まずはこれでよい。日本語ブログをインポートするときには、自動化で悩むことにする。</p>
<p>ためしにインポートしてみたら、</p>
<blockquote><p>Imports may take up to 24 hours to complete.</p></blockquote>
<p>と表示される。日本語訳すると「インポート作業は 24 時間かかるかもしれないよ」。</p>
<p>さすがにそんなにかかるわけはないだろう、と思ったものの、実際に 1 日ぐらいかかった。さらに、Importer に遅れが生じていときには、1 日以上待たされることもあった。</p>
<p>アップロードして、結果が分かるのが 1 日後なのである。XML にミスがあって、インポートに失敗した場合には</p>
<ul><li>1 日目: アップロード</li><li>2 日目: うまくいってなかったことが分かる。修正してアップロード</li><li>3 日目: 成功していたことが分かる</li></ul>
<p>と、わずか 1 ミスで 3 日かかってしまうのだ・・・。</p>
<p>ちなみに、自分のインポートの進捗状況は <a href="http://import.disqus.com">http://import.disqus.com</a>、サービス全体 Importer の動作状況は <a href="http://status.disqus.com">http://status.disqus.com</a> で確認できるようになっている。</p>
<p>(追記 2012/08/04) 再度、やってみたところ、数分以内にインポートが終了した。たまたま Importer の調子が悪かったようだ。</p>
<h1>コメント フォーマットの CDATA にやられる</h1>
<p>XML の作成については、基本的に <a href="http://help.disqus.com/customer/portal/articles/472150-custom-xml-import-format">DISQUS - Custom XML Import Format</a> に従えばいい。</p>
<p>たとえばコメント本文は</p>
<div class="highlight"><pre>  <span class="c">&lt;!-- comment body; use cdata; html allowed (though will be formatted to DISQUS specs) --&gt;</span>
  <span class="nt">&lt;wp:comment_content&gt;</span><span class="cp">&lt;![CDATA[Hello world]]&gt;</span><span class="nt">&lt;/wp:comment_content&gt;</span>
</pre>
</div>

<p>のような形式で書くことになっている。</p>
<p>仕様を読んだつもりであったのだが「CDATA を使え」を見逃していた。</p>
<p>つまり、本当は CDATA を使って</p>
<div class="highlight"><pre>  <span class="nt">&lt;wp:comment_content&gt;</span><span class="cp">&lt;![CDATA[I&#39;m nitoyon]]&gt;</span><span class="nt">&lt;/wp:comment_content&gt;</span>
</pre>
</div>

<p>と書くべきところを、</p>
<div class="highlight"><pre>  <span class="nt">&lt;wp:comment_content&gt;</span>I<span class="ni">&amp;apos;</span>m nitoyon<span class="nt">&lt;/wp:comment_content&gt;</span>
</pre>
</div>

<p>としていた。</p>
<p>まっとうな XML パーサーを使っていれば、<code>&amp;apos;</code> はシングルクオートになるはずなのだが、インポート結果を見てみると、<code>I&amp;aposm nitoyon</code> となっていた・・・。</p>
<p>インポート後にコメントを編集はできるのだが、コメントの末尾に「(Edited by a moderator)」と表示されてしまう。これでは印象が悪いので、結局最初からやり直すことにした。</p>
<p>やりなおしすると、当然、1 日待たねばならない。いま、それを待っているところである・・・。</p>
<h1>まとめ</h1>
<p>DISQUS のインポートは用意周到に。締め切りのあるケースではやりたくない作業である。</p>]]></description>
		</item>

		<item>
			<title>英語ブログを新調した話と移転計画</title>
			<link>http://tech.nitoyon.com/ja/blog/2012/06/27/english-blog-renewal/</link>
			<guid>http://tech.nitoyon.com/ja/blog/2012/06/27/english-blog-renewal/</guid>
			<pubDate>Wed, 27 Jun 2012 00:00:00 +0900</pubDate>
			<description><![CDATA[<p>放置していた<a href="http://tech.nitoyon.com/en/blog/">英語ブログ</a>をこのブログと同じデザインに統一した。</p>
<p>英語ブログ、以前は MovableType を使ってたんだけど、いろいろ面倒になったので Jekyll で作り直した。Jekyll は Github Pages に使われている静的コンテンツ ジェネレータ。Ruby で作られていて、コードはシンプル、プラグイン機構もあるので、カスタマイズしやすい。</p>
<p>Jekyll については次のページが分かりやすかった。</p>
<ul><li><a href="http://mattn.kaoriya.net/software/lang/ruby/20090409185248.htm">Big Sky :: Jekyllで始める簡単ブログ</a></li></ul>
<p>ソースコードは <a href="https://github.com/nitoyon/tech.nitoyon.com">https://github.com/nitoyon/tech.nitoyon.com</a> で公開している。</p>
<h1>このブログも移動させようと準備中</h1>
<p>せっかく英語ブログも新調したので、このブログも <a href="http://tech.nitoyon.com/ja/blog/">http://tech.nitoyon.com/ja/blog/</a> あたりに移動させようと準備している。</p>
<a name="seemore"></a>
<p>理由としては色々あるんだけど、ざっと挙げると・・・</p>
<ul><li>CSS3 でブログのデザインを<a href="http://d.hatena.ne.jp/nitoyon/20120313/newdesign2012">新しくした</a>のに、はてなダイアリーは <code>DOCTYPE</code> が互換モードになっている。つまり、IE9 で CSS3 が有効にならない。</li><li>はてなブログも気にはなるんだけど、<ul><li>もう一回最初から進化に付き合う気にはなれない。システムの制約で新しいことを試せないのが悲しい。</li><li>スマートフォン版のデザインをカスタマイズできない。 いま流行のレスポンシブ Web デザインをやってみたい。</li><li>AdSense の位置をいろいろ試してみたい。コピペできない文章のすぐ下に AdSense 置いたら普段の倍ぐらいの RPM（収益/PV）になって驚いた。そのあたりのノウハウも身につけてみたい。</li></ul></li></ul>
<p>どうせ移転するなら過去の記事も全部移動させたい。しかし、数百件の過去記事を手で Markdown に変換するのは嫌だ。そこで、Ruby で「はてな記法」を扱える hparser を組み込もうとしている。ただ、自分が使ってる記法がサポートされていないものがあったので、hparser 本体にも手を入れたりして、なかなかの大作業になっている。</p>
<p>やっかいなのが twitter 記法と amazon 記法。この 2 つについては Web サービスへのリクエストが必要になるので、リクエスト結果をキャッシュする仕組みもほしくなる。</p>
<p>また、Jekyll で数百の記事をパブリッシュすると完了までに時間がかかりすぎるので、ここにも何らかのキャッシュが必要になる。コメントの扱いも難しい。静的コンテンツなので facebook なり DISQUS を使うことになるんだろうか。このあたりの外部サービスによって変化する空気感も気になる。</p>
<br />
<p>以上のように、最近、はてなダイアリーの劣化コピーを作りにいそしんでいる。こうやって一つ一つ作業をこなしていると、はてなダイアリーがいかに便利だったかをあらためて実感することにもなる。</p>
<p>奮闘中の様子は <a href="https://github.com/nitoyon/tech.nitoyon.com">https://github.com/nitoyon/tech.nitoyon.com</a> を見れば分かるようになっているので、興味がある人はウォッチしてみてほしい。いまは楽しんで作っているけど、途中で飽きて、しれっとはてなダイアリーで書き続けているかもしれない・・・。</p>]]></description>
		</item>

		<item>
			<title>飛び出る Google マップを作ってみた</title>
			<link>http://tech.nitoyon.com/ja/blog/2012/05/24/stereoscopic-maps/</link>
			<guid>http://tech.nitoyon.com/ja/blog/2012/05/24/stereoscopic-maps/</guid>
			<pubDate>Thu, 24 May 2012 00:00:00 +0900</pubDate>
			<description><![CDATA[<p>あまり知られていないけど、Google マップには <a href="http://support.google.com/maps/bin/answer.py?hl=ja&answer=1630790">MapsGL</a> というのがあって一部の建物が 3D 表示になったりする。</p>
<p>といっても Google Earth のように角度を変えて表示したりはできないんだけど、地図をスクロールすると高い建物の傾き具合が変化する。この表示方法のことを、Google では「parallax (視差効果)」と<a href="http://google-latlong.blogspot.jp/2012/04/see-3d-buildings-in-whole-new-way-with.html">呼んでいる</a>ようだ。</p>
<p>「視差」という言葉で思い出すのは<strong>立体視</strong>。</p>
<p>MapsGL の視差効果を使えば、立体視を作れそう！</p>
<p>試しに作ってみた。</p>
<a name="seemore"></a>
<h1>飛び出る東京都庁</h1>
<p>どうせなら高いビルを立体視したい。思いついたのは西新宿のオフィス街。</p>
<p>その中でもひときわ目立つ <a href="http://maps.google.com/maps?hl=en&ll=35.689098,139.69359&spn=0.003438,0.008256&t=v&z=18&vector=1">東京都庁</a>で試してみた。</p>
<h2>平行法</h2>
<center><a href="http://f.hatena.ne.jp/nitoyon/20120524021445"><img src="http://f.hatena.ne.jp/images/fotolife/n/nitoyon/20120524/20120524021445.png"></a></center>
<h2>交差法</h2>
<center><a href="http://f.hatena.ne.jp/nitoyon/20120524021446"><img src="http://f.hatena.ne.jp/images/fotolife/n/nitoyon/20120524/20120524021446.png"></a></center>
<h1>飛び出るビッグベン</h1>
<p>お次は、ロンドンの <a href="http://maps.google.com/maps?hl=en&ll=51.49996,-0.124205&spn=0.004091,0.005493&t=v&z=18&vector=1">ビッグ・ベン</a>。複雑な建物の構造が再現されているので、なかなかいい立体感だ。</p>
<h2>平行法</h2>
<center><a href="http://f.hatena.ne.jp/nitoyon/20120524021442"><img src="http://f.hatena.ne.jp/images/fotolife/n/nitoyon/20120524/20120524021442.png"></a></center>
<h2>交差法</h2>
<center><a href="http://f.hatena.ne.jp/nitoyon/20120524021443"><img src="http://f.hatena.ne.jp/images/fotolife/n/nitoyon/20120524/20120524021443.png"></a></center>
<h1>浮き上がりましたか？</h1>
<p>それなりに立体にみえて面白い。本当はもっといっぱい作りたかったけど、2 個で力尽きた。</p>
<p>作る手順はこんな感じ。</p>
<ol><li>MapsGL の地図で適当な建物を探す。</li><li>画面をキャプチャする。</li><li>キーボードで左右どちらかに少しずらす。</li><li>もう一枚キャプチャする。</li><li>2 つの画像を横に並べる。</li></ol>
<p>ただ、手作業でやるのは面倒だ。</p>
<p>MapGL 版の Google マップが API から使えるようになったら、「Google マップ 立体視ビューワー」のようなものを作って自動化してみたいところ。ただ、MapsGL は WebGL 技術を利用していて、WebGL は Internet Explorer では利用できないという状況から、MapsGL が今後、どういう運命をたどっていくか、先行き不透明ではある。</p>
<div class="seealso">
<h1>あわせてどうぞ</h1>
<ul><li><a href="/ja/blog/2012/02/28/why-google-still-uses-flash/">Google がまだ Flash を使っているサービスでみる脱 Flash の難しさ</a></li><li><a href="/ja/blog/2011/09/07/end-of-maps-api-for-flash/">Google Maps API for Flash が廃止、3年でサポート打ち切り</a></li><li><a href="/ja/blog/2011/04/26/messages-for-japan-design/">Messages for Japan に見る Google UI デザインの変化</a></li><li><a href="/ja/blog/2011/02/28/diorama-google-maps/">Google Maps をジオラマ風にしてみた</a></li><li><a href="http://tech.nitoyon.com/javascript/application/racing/1/">Google Maps で鈴鹿サーキット試走</a></li></ul>
</div>]]></description>
		</item>

		<item>
			<title>コンプガチャだけじゃない!?　ガチャに潜む確率の罠</title>
			<link>http://tech.nitoyon.com/ja/blog/2012/05/17/gacha-probability/</link>
			<guid>http://tech.nitoyon.com/ja/blog/2012/05/17/gacha-probability/</guid>
			<pubDate>Thu, 17 May 2012 00:00:00 +0900</pubDate>
			<description><![CDATA[<p>twitter をみていたら、こんなツイートが回ってきました。</p>
<blockquote class="twitter-tweet" lang="ja"><p>モバゲー・GREEが確率明示しないのは、搾り取るためというよりは、クレーム対応減らすため。1％でSR、って書くと「100回引いたのに出ない。詐欺だ」。確率だから、って説明すると彼らはこう返す「だから、100回に1回出るんでしょ？」…さあ、どう返そうか。</p>&mdash; saintear/セインティアさん (@saintearRX) <a href="https://twitter.com/saintearRX/status/199049818738401280" data-datetime="2012-05-06T08:15:49+00:00">5月 6, 2012</a></blockquote>
<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>たしかに「1% のガチャを 100 回引いたら当たる」と思い込んでしまう人は多そうです。</p>
<p>では、1% のガチャを 100 回引くと、どれぐらいの人が当たり、どれぐらいの人が当たらないのでしょうか。</p>
<a name="seemore"></a>
<h1>1% のガチャを 100 回引いて当たらない確率は？</h1>
<p>さっそく計算してみましょう。</p>
<p>1 回ガチャを引いて当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cfrac%7B99%7D%7B100%7D" class="tex" alt="\frac{99}{100}"> です。当たる確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=1-%5Cfrac%7B99%7D%7B100%7D" class="tex" alt="1-\frac{99}{100}"> = 1% です。</p>
<p>2 回ガチャを引いたときに、1 度も当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E2" class="tex" alt="\left(\frac{99}{100}\right)^2"> です。つまり、1 回以上当たる確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=1-%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E2" class="tex" alt="1-\left(\frac{99}{100}\right)^2"> = 1.9% となります。</p>
<p>3 回ガチャを引いたときに、1 度も当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E3" class="tex" alt="\left(\frac{99}{100}\right)^3"> です。1 回以上当たる確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=1-%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E3" class="tex" alt="1-\left(\frac{99}{100}\right)^3"> で 2.7% です。</p>
<p>同じように計算していくと、結果はこうなります。</p>
<table>
<tr><th>ケース</th><th>まったく当たらない確率</th><th>1 回以上当たる確率</th></tr>
<tr><td>1 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cfrac%7B99%7D%7B100%7D%3D99.0%25" class="tex" alt="\frac{99}{100}=99.0%"></td><td class="right">1.0%</td></th>
<tr><td>2 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E2%3D98.1%25" class="tex" alt="\left(\frac{99}{100}\right)^2=98.1%"></td><td class="right">1.9%</td></th>
<tr><td>3 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E3%3D97.3%25" class="tex" alt="\left(\frac{99}{100}\right)^3=97.3%"></td><td class="right">2.7%</td></th>
<tr><td class="center">:</td><td class="center">:</td><td class="center">:</td></th>
<tr><td>100 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E%7B100%7D%3D36.6%25" class="tex" alt="\left(\frac{99}{100}\right)^{100}=36.6%"></td><td class="right">63.4%</td></th>
</table>
<br />
<p><strong>1% のガチャを 100 回引いて 1 度も当たらない人は36.6%</strong>います。</p>
<p>当たらない人が意外に多いように感じませんか？</p>
<p>確率 1% は「100 回引けば必ず 1 回当たる」を意味するのではなく、「平均すると100 回に 1 回は出る」ことを意味します。100 回引いて 2 回も 3 回も当たる人がいる一方で、36.6% の人は 1 つも当たらずに終わってしまいます。</p>
<br />
<p>では、100 回以降も引き続けたとき、当たらない人の割合はどのように変わっていくのでしょうか。</p>
<p>グラフを描いてみました。</p>
<center><img src="http://img.f.hatena.ne.jp/images/fotolife/n/nitoyon/20120517/20120517021601.png"></center>
<p>グラフから面白い性質が読み取れます。</p>
<ul><li>1% のガチャを70 回ほど引いたところで半数の人は 1 度は当たる</li><li>1% のガチャを 100 回引いても 36.6% の人は当たりが出ない</li><li>1% のガチャを 200 回引いても 13.4% の人は当たりが出ない</li><li>1% のガチャを 300 回引いても 4.9% の人は当たりが出ない</li></ul>
<p>20 人に1人は 300 回引いても当たりが出ません。これは恐怖です。</p>
<h1>確率を変えて見えてくる 36% の不思議</h1>
<p>ここまで、1% のガチャで調べてきましたが、ガチャの確率をいろいろ変えて計算してみましょう。</p>
<table>
<tr><th>ケース</th><th>まったく当たらない確率</th><th>1 回以上当たる確率</th></tr>
<tr><td>20% のガチャを 5 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B80%7D%7B100%7D%5Cright%29%5E5%3D32.8%25" class="tex" alt="\left(\frac{80}{100}\right)^5=32.8%"></td><td class="right">67.2%</td></tr>
<tr><td>10% のガチャを 10 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B90%7D%7B100%7D%5Cright%29%5E%7B10%7D%3D34.9%25" class="tex" alt="\left(\frac{90}{100}\right)^{10}=34.9%"></td><td class="right">65.1%</td></tr>
<tr><td>5% のガチャを 20 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B95%7D%7B100%7D%5Cright%29%5E%7B20%7D%3D35.8%25" class="tex" alt="\left(\frac{95}{100}\right)^{20}=35.8%"></td><td class="right">64.1%</td></tr>
<tr><td>1% のガチャを 100 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99%7D%7B100%7D%5Cright%29%5E%7B100%7D%3D36.6%25" class="tex" alt="\left(\frac{99}{100}\right)^{100}=36.6%"></td><td class="right">63.4%</td></tr>
<tr><td>0.5% のガチャを 200 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99.5%7D%7B100%7D%5Cright%29%5E%7B200%7D%3D36.7%25" class="tex" alt="\left(\frac{99.5}{100}\right)^{200}=36.7%"></td><td class="right">63.3%</td></tr>
<tr><td>0.1% のガチャを 1000 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99.9%7D%7B100%7D%5Cright%29%5E%7B1000%7D%3D36.7%25" class="tex" alt="\left(\frac{99.9}{100}\right)^{1000}=36.7%"></td><td class="right">63.3%</td></tr>
<tr><td>0.01% のガチャを 10000 回引いたとき</td><td class="center"><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%28%5Cfrac%7B99.99%7D%7B100%7D%5Cright%29%5E%7B10000%7D%3D36.8%25" class="tex" alt="\left(\frac{99.99}{100}\right)^{10000}=36.8%"></td><td class="right">63.2%</td></tr>
</table>
<p>あれ？　ガチャの確率が 1% 以下だと、</p>
<ul><li>まったく当たらない確率: 36.X%</li><li>1 回以上当たる確率: 63.X%</li></ul>
<p>とほとんど同じ値です。</p>
<p>この不思議な性質は、パチンコをやる人には比較的知られている数字のようです。</p>
<blockquote><p>この<strong>63%という数字はとても不思議な数字</strong>です。パチンコ台にはデジハネ（ハネデジと記載してい雑誌もあります）のように初当たり確率pが1/100前後の台から、エヴァンゲリオンのように1/400くらいの台まで様々な台がありますが、この数式で計算すると<strong>どんなスペックのパチンコ台でも1/p回転以内に初当たりが引ける確率は必ず63%</strong>になります。</p><cite><a href="http://pachitop.seesaa.net/article/36072620.html">パチンコのはまりと初当たり確率の関係:パチンコ、負けない立ち回りと確率の密接な関係</a></cite></blockquote>
<p>「36% の謎」。気になりますよね。高校数学を使って解き明かしてみましょう。</p>
<h2>36% の謎を解く (高校3年生向け)</h2>
<p>ここからは高校 3 年生の知識が必要になるので、少し難しくなります。（数学が苦手な人は飛ばしてください）</p>
<p>1% のガチャを 100 回引いて、一度も当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%281-%5Cfrac%7B1%7D%7B100%7D%5Cright%29%5E%7B100%7D" class="tex" alt="\left(1-\frac{1}{100}\right)^{100}"> です。</p>
<p>0.1% のガチャを 1000 回引いて、1度も当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%281-%5Cfrac%7B1%7D%7B1000%7D%5Cright%29%5E%7B1000%7D" class="tex" alt="\left(1-\frac{1}{1000}\right)^{1000}"> です。</p>
<p>これを一般化すると、次のようになります。</p>
<blockquote><p>確率 1/n のガチャを n 回引く確率いて 1 度も当たらない確率は <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Cleft%281-%5Cfrac%7B1%7D%7Bn%7D%5Cright%29%5E%7Bn%7D" class="tex" alt="\left(1-\frac{1}{n}\right)^{n}"></p></blockquote>
<p>n を大きくしていったときの、</p>
<center><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Clim_%7Bn%5Cright%5Cinfty%7D%5Cleft%281-%5Cfrac%7B1%7D%7Bn%7D%5Cright%29%5E%7Bn%7D" class="tex" alt="\lim_{n\right\infty}\left(1-\frac{1}{n}\right)^{n}"></center>
<p>が求めたい値です。</p>
<br />
<p>ところで、指数関数 <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=e%5Ex" class="tex" alt="e^x"> を原点で微分すると <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Clim_%7Bt%5Cright0%7D%5Cfrac%7Be%5Et-1%7D%7Bt%7D%3D1" class="tex" alt="\lim_{t\right0}\frac{e^t-1}{t}=1"> となります。ここに <img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=t%3D%5Clog%5Cleft%281%252B%5Cfrac%7Ba%7D%7Bn%7D%5Cright%29" class="tex" alt="t=\log\left(1%2B\frac{a}{n}\right)"> を代入すると、</p>
<center><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Clim_%7Bn%5Cright%5Cinfty%7D%5Cleft%281%252B%5Cfrac%7Ba%7D%7Bn%7D%5Cright%29%5En%3De%5Ea" class="tex" alt="\lim_{n\right\infty}\left(1%2B\frac{a}{n}\right)^n=e^a"></center>
<p>という式を得ます。</p>
<p>この式に a = -1 を代入すると、</p>
<center><img src="http://chart.apis.google.com/chart?cht=tx&chf=bg,s,00000000&chl=%5Clim_%7Bn%5Cright%5Cinfty%7D%5Cleft%281-%5Cfrac%7B1%7D%7Bn%7D%5Cright%29%5E%7Bn%7D%3D%5Cfrac%7B1%7D%7Be%7D%3D0.367879..." class="tex" alt="\lim_{n\right\infty}\left(1-\frac{1}{n}\right)^{n}=\frac{1}{e}=0.367879..."></center>
<p>となります。</p>
<br />
<p>はい、以上で 36% の正体が分かりました。<strong>1 / e</strong> だったのです（e は自然対数の底 2.71828...)。</p>
<p>こんなところで、自然対数が出てくるのが不思議ですね。</p>
<p>同じ計算は複利計算にも応用できます。例えば、年利 1% で 100 年運用すると、資産はほぼ e 倍になります。</p>
<h1>まとめ</h1>
<p>「1% のガチャを 100 回引いても 36% の人は当たらない」ことが分かりました。</p>
<p>確率を変えて計算したところ、「1/n の確率のガチャを n 回引いても 36% の人は当たらない」(n≧100)という性質があることが分かりました。</p>
<p>この「36%」の罠は、パチンコにも存在します。パチンコとガチャが「36%」の罠でつながりました。</p>
<p>一方は法律で 18 歳未満は禁止されていて、ギャンブルであると世間では認知されていますが、もう一方は「ゲーム」であり、年齢制限はありません。</p>
<p>パチンコと似ているからといって、すぐに「賭博だ」「違法だ」とはなりません。「36%」の罠は、自然界や多くのゲームに潜んでいます。</p>
<p>ただ、最初に紹介した、</p>
<blockquote class="twitter-tweet" lang="ja"><p>モバゲー・GREEが確率明示しないのは、搾り取るためというよりは、クレーム対応減らすため。1％でSR、って書くと「100回引いたのに出ない。詐欺だ」。確率だから、って説明すると彼らはこう返す「だから、100回に1回出るんでしょ？」…さあ、どう返そうか。</p>&mdash; saintear/セインティアさん (@saintearRX) <a href="https://twitter.com/saintearRX/status/199049818738401280" data-datetime="2012-05-06T08:15:49+00:00">5月 6, 2012</a></blockquote>
<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>というツイートは、ギャンブル慣れしていない大人や学生にギャンブル的なゲームを提供している状況を象徴しているように思えます。</p>
<br />
<p>※コンプガチャについても記事を書いていますので、興味のある方はどうぞ!!! → <a href="/ja/blog/2012/05/11/comp-gacha-probability/">コンプガチャの確率マジックを中学生にも分かるように説明するよ</a></p>
<div class="seealso">
<h1>あわせてどうぞ</h1>
<ul><li><a href="/ja/blog/2012/05/11/comp-gacha-probability/">コンプガチャの確率マジックを中学生にも分かるように説明するよ</a></li><li><a href="/ja/blog/2012/04/20/uncopyable/">絶対にコピペできない文章を作ったったwwww</a></li><li><a href="/ja/blog/2012/03/06/inexpensive-moving/">段ボール15箱の引っ越し（東京→京都）が2万円以内になった節約術</a></li><li><a href="/ja/blog/2012/02/14/original-shachihata/">シヤチハタ印鑑をカスタマイズ注文してみた</a></li><li><a href="/ja/blog/2009/04/15/hokkaido/">北海道を落とすとどう跳ねるのか？</a></li></ul>
</div>]]></description>
		</item>

	</channel>
</rss>